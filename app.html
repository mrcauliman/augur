<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DL Demo Dashboard</title>
  <style>
    :root{--bg:#070a0e;--panel:#0d141d;--panel2:#0b1118;--fg:#e7eef8;--muted:#9fb0c6;--line:#203048;--a:#8fb7ff;--mono:ui-monospace,Menlo,Consolas,monospace}
    html,body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:var(--a);text-decoration:none}
    .wrap{max-width:1100px;margin:0 auto;padding:28px 16px 80px}
    .top{display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:center}
    h1{margin:0;font-size:22px}
    .card{border:1px solid var(--line);border-radius:16px;background:linear-gradient(180deg,var(--panel),var(--panel2));padding:16px;margin-top:12px}
    .k{display:inline-block;padding:2px 8px;border:1px solid var(--line);border-radius:999px;color:var(--muted);font-size:12px;margin-right:8px;margin-bottom:8px}
    .grid{display:grid;gap:12px}
    @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}
    pre{margin:0;background:#05070a;border:1px solid var(--line);border-radius:12px;padding:12px;overflow:auto;font-family:var(--mono);font-size:12.5px;color:#cfe4ff}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid var(--line);text-align:left}
    th{color:var(--muted);font-weight:700}
    code{font-family:var(--mono)}
    .muted{color:var(--muted)}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;border-radius:12px;border:1px solid var(--line);background:#05070a;color:var(--fg);font-weight:700}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>Digital Ledger Demo Dashboard</h1>
        <div class="k">DL v1</div><div class="k">GitHub Pages demo</div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <a class="btn" href="index.html">Home</a>
        <a class="btn" href="runbook.html">Runbook</a>
      </div>
    </div>

    <div class="card">
      <span class="k">data source</span>
      <p class="muted" style="margin:8px 0">Reading <code>demo/summary.json</code></p>
      <pre id="raw">loading...</pre>
    </div>

    <div class="grid">
      <div class="card">
        <span class="k">month totals</span>
        <div id="totals" class="muted" style="margin-top:8px">loading...</div>
      </div>
      <div class="card">
        <span class="k">accounts</span>
        <div id="acctCount" class="muted" style="margin-top:8px">loading...</div>
      </div>
    </div>

    <div class="card">
      <span class="k">account breakdown</span>
      <div style="overflow:auto;margin-top:8px">
        <table id="tbl">
          <thead>
            <tr><th>Label</th><th>Chain</th><th>In</th><th>Out</th><th>Tx</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

  </div>

<script>
(async () => {
const resp = await fetch("public_data/summary.json", { cache: "no-store" });
  const data = await resp.json();

  document.getElementById("raw").textContent = JSON.stringify(data, null, 2);

  const t = data.totals || {};
  document.getElementById("totals").innerHTML =
    `<div class="k">${data.month || ""}</div>
     <div>in_xrp: <b>${t.in_xrp ?? 0}</b></div>
     <div>out_xrp: <b>${t.out_xrp ?? 0}</b></div>
     <div>fee_xrp: <b>${t.fee_xrp ?? 0}</b></div>
     <div>tx_count: <b>${t.tx_count ?? 0}</b></div>`;

  const accts = Array.isArray(data.accounts) ? data.accounts : [];
  document.getElementById("acctCount").textContent = `${accts.length} account(s) in report`;

  const tbody = document.querySelector("#tbl tbody");
  tbody.innerHTML = "";
  for (const a of accts) {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${a.label || a.account_id || ""}</td>
                    <td>${a.chain || ""}</td>
                    <td>${a.in_xrp ?? 0}</td>
                    <td>${a.out_xrp ?? 0}</td>
                    <td>${a.tx_count ?? 0}</td>`;
    tbody.appendChild(tr);
  }
})();
</script>
</body>
</html>
